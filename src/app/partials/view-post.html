<div ng-controller = "ViewPostCtrl" class = "container-fluid">
    <div ng-show="user.rank <= 3" class="ng-cloak">
        <div class="alert" ng-class="{'alert-info': post.published}">
            <div ng-show="!post.published"><strong>Unpublished!</strong> This article is not yet published; it is viewable only by the author and site admins.<span></span></div>
            <div ng-show="post.published"><strong>Published!</strong> This article is published; it is viewable by everyone</div>
        </div>
        <div class="well well-small">
            <button class="btn btn-small btn-primary" ng-show="!post.published && user.rank <= 2" ng-click="publish()"><i class="icon-eye-open icon-white"></i> Publish</button>
            <button class="btn btn-small btn-warning" ng-show="post.published && user.rank <= 2" ng-click="unpublish()"><i class="icon-eye-close icon-white"></i> Unpublish</button>
            <button class="btn btn-small" ng-click="edit()"><i class="icon-edit"></i> Edit</button>
            <button class="btn btn-small btn-danger" ng-click="deleteArticle()"><i class="icon-trash icon-white"></i> Delete</button>
        </div>
    </div>

    <legend class = "view-title-legend">{{ post.title }}</legend>
    <div class = "view-post-user-info">by <a ng-href = '/user/{{ post.uid }}'>{{ post.name }}</a> at {{ extractDate(post.date) }}</div>
    <div ng-show = "post.img" class = "row-fluid  view-post-image-divider">
        <div class = "span8 offset2 view-post-image-div"><img class = "view-post-image centerer" ng-src = "{{ articlePic(post.img) }}"/></div>
    </div>
    <div class = "view-post-article"><p ng-bind-html-unsafe="post.article"></p></div>

    <div class = "row-fluid">


            <p>({{ post.commentCount }} comments)</p>


    </div>
    <div class = "well well-small">

        <div ng-hide = "loggedIn">Please <a ng-href = '/sign-in'>log in</a> to post comments.</div>
        <div id = "comments" class = "row-fluid" ng-hide = "!loggedIn">
            <form ng-submit = "postComment()">
                <textarea class = "span12" ng-model = "content" required></textarea>
                <button type = "submit">Post comment</button>
            </form>
        </div>
        <div class = "row-fluid">
            <ul class = "unstyled">
                <li class = "row-fluid comment-list" ng-repeat = "comment in comments">
                    <div class = "span2 comment-center"> <img ng-show = "comment.img" class = "img-polaroid comment-img" ng-src = "{{ profilePic(comment.img) }}"> </div>
                    <div class = "span10">
                        <div class = "comment-username" class = "span12">
                            <a href = #>{{ comment.name }}</a> <span class = "pull-right comment-date"> {{ extractDate(comment.date)}}</span>
                        </div>
                        <div class = "comment-content">{{ comment.content | commentFilter }}</div> <div class = "comment-warn-icon"><i ng-show = "user.rank > 2" ng-click = "reportComment(comment._id)" title = "Report this comment" class = "icon-warning-sign"></i><i ng-show = "user.rank <= 2" ng-click = "deleteComment(comment._id)" title = "Delete this comment" class = "icon-trash"></i></div>
                    </div>

                </li>
            </ul>

        </div>

    </div>

</div>